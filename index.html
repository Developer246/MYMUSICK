<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8">
  <title>MYMUSICK</title>
  <link rel="icon" href="img/Logo.png">
  <link rel="stylesheet" href="estilo.css">

    
</head>

<body>

<header>
  <div class="lgimg">
    <img src="img/Logo.png" alt="Logo MYMUSICK">
    <h1 class="title">MYMUSICK</h1>
  </div>

  <div class="ctsearch">
    <input class="search" type="search" placeholder="Busca tu MÃºsica ðŸŽµ">
  </div>

  <button class="bttlg" type="button" onclick="document.getElementById('login').showModal()">Iniciar SesiÃ³n</button>
</header>
<aside class="sidebar">
 <a href="#home"><i class="fa fa-fw fa-home"></i> Home</a>
  <a href="#services"><i class="fa fa-fw fa-wrench"></i> Services</a>
  <a href="#clients"><i class="fa fa-fw fa-user"></i> Clients</a>
  <a href="#contact"><i class="fa fa-fw fa-envelope"></i> Contact</a>
</aside>
  
<p class="intxt">Â¿QuÃ© vas a escuchar hoy?</p>
  <div id="results"></div>
<script>
const input = document.querySelector(".search");
const results = document.getElementById("results");

input.addEventListener("keydown", async (e) => {
  if (e.key !== "Enter") return;

  const query = input.value.trim();
  if (!query) return;

  results.innerHTML = "Buscando... ðŸŽ¶";

  try {
    const res = await fetch(
      "https://mymusick-backend.onrender.com/search?q=" +
      encodeURIComponent(query)
    );

    const songs = await res.json();
    renderSongs(songs);
  } catch (err) {
    results.innerHTML = "Error al buscar ðŸ˜¢";
    console.error(err);
  }
});

function renderSongs(songs) {
  results.innerHTML = "";

  if (!Array.isArray(songs) || songs.length === 0) {
    results.innerHTML = "No se encontraron canciones";
    return;
  }

  songs.forEach(song => {
    const div = document.createElement("div");
    div.className = "song";

    div.innerHTML = `
      <img src="${song.thumbnail}" width="120" style="border-radius:12px"><br>
      ðŸŽµ <strong>${song.title}</strong><br>
      <small>${song.artist}</small>
    `;

div.onclick = () => {
  loadSong(song.id);
};
results.appendChild(div);
  });
}
</script>

  <dialog id="login" closedby="any">
  <form method="dialog" class="login-form">
    <h3 class="intex">Iniciar SesiÃ³n</h3>

    <label for="email" class="labels">Mail</label>
    <input id="email" class="input-field" type="email" required placeholder="Escribe tu Email">

    <label for="pass" class="labels">ContraseÃ±a</label>
    <input id="pass" class="input-field" type="password" required placeholder="Tu ContraseÃ±a">

    <button type="submit" class="bttlg">Enviar</button>
  </form>
</dialog>
  
<footer class="player">
  <button id="playPauseBtn" onclick="togglePlay()"></button>
  <div id="yt-player" style="width:0;height:0;overflow:hidden"></div>
</footer>

<script src="https://www.youtube.com/iframe_api"></script>
<script>
let player;
let currentVideoId = null;
let isPlaying = false;

function onYouTubeIframeAPIReady() {
  player = new YT.Player("yt-player", {
    height: "0",
    width: "0",
    videoId: "",
    playerVars: {
      autoplay: 0,
      controls: 0
    }
  });
}

function loadSong(videoId) {
  currentVideoId = videoId;
  isPlaying = true;
  player.loadVideoById(videoId);
  updateButton();
}

function togglePlay() {
  if (!player || !currentVideoId) return;

  if (isPlaying) {
    player.pauseVideo();
    isPlaying = false;
  } else {
    player.playVideo();
    isPlaying = true;
  }

  updateButton();
}

function updateButton() {
  const btn = document.getElementById("playPauseBtn");
  btn.textContent = isPlaying ? "||" : "â–¶ï¸Ž";
}
</script>

</body>
</html>
